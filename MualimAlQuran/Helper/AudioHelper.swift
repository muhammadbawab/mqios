import SwiftUI

func firstLetter(audioID: Int) -> Int {
    
    var _audioID = audioID;
    if (audioID == 4) {
        _audioID = 79;
    }
    else if (audioID == 7) {
        _audioID = 52;
    }
    else if (audioID == 10) {
        _audioID = 70;
    }
    else if (audioID == 13) {
        _audioID = 25;
    }
    else if (audioID == 16) {
        _audioID = 10;
    }
    else if (audioID == 19) {
        _audioID = 16;
    }
    else if (audioID == 22) {
        _audioID = 49;
    }
    else if (audioID == 25) {
        _audioID = 67;
    }
    else if (audioID == 28) {
        _audioID = 43;
    }
    else if (audioID == 31) {
        _audioID = 61;
    }
    else if (audioID == 34) {
        _audioID = 58;
    }
    else if (audioID == 37) {
        _audioID = 28;
    }
    else if (audioID == 40) {
        _audioID = 55;
    }
    else if (audioID == 43) {
        _audioID = 34;
    }
    else if (audioID == 46) {
        _audioID = 46;
    }
    else if (audioID == 49) {
        _audioID = 64;
    }
    else if (audioID == 52) {
        _audioID = 7;
    }
    else if (audioID == 55) {
        _audioID = 13;
    }
    else if (audioID == 58) {
        _audioID = 73;
    }
    else if (audioID == 61) {
        _audioID = 19;
    }
    else if (audioID == 64) {
        _audioID = 22;
    }
    else if (audioID == 67) {
        _audioID = 37;
    }
    else if (audioID == 70) {
        _audioID = 82;
    }
    else if (audioID == 73) {
        _audioID = 40;
    }
    else if (audioID == 76) {
        _audioID = 76;
    }
    else if (audioID == 79) {
        _audioID = 4;
    }
    else if (audioID == 82) {
        _audioID = 1;
    }
    else if (audioID == 85) {
        _audioID = 31;
    }
    else if (audioID == 88) {
        _audioID = 82;
    }
    else if (audioID == 91) {
        _audioID = 4;
    }
    else if (audioID == 94) {
        _audioID = 31;
    }
    else if (audioID == 97) {
        _audioID = 13;
    }
    else if (audioID == 100) {
        _audioID = 58;
    }
    else if (audioID == 103) {
        _audioID = 73;
    }
    else if (audioID == 106) {
        _audioID = 67;
    }
    else if (audioID == 109) {
        _audioID = 34;
    }
    else if (audioID == 112) {
        _audioID = 16;
    }
    else if (audioID == 115) {
        _audioID = 40;
    }
    else if (audioID == 118) {
        _audioID = 22;
    }
    else if (audioID == 121) {
        _audioID = 25;
    }
    else if (audioID == 124) {
        _audioID = 55;
    }
    else if (audioID == 127) {
        _audioID = 28;
    }
    else if (audioID == 130) {
        _audioID = 49;
    }
    else if (audioID == 133) {
        _audioID = 37;
    }
    else if (audioID == 136) {
        _audioID = 19;
    }
    else if (audioID == 139) {
        _audioID = 76;
    }
    else if (audioID == 142) {
        _audioID = 70;
    }
    else if (audioID == 145) {
        _audioID = 10;
    }
    else if (audioID == 148) {
        _audioID = 64;
    }
    else if (audioID == 151) {
        _audioID = 61;
    }
    else if (audioID == 154) {
        _audioID = 46;
    }
    else if (audioID == 157) {
        _audioID = 1;
    }
    else if (audioID == 160) {
        _audioID = 43;
    }
    else if (audioID == 163) {
        _audioID = 7;
    }
    else if (audioID == 166) {
        _audioID = 79;
    }
    else if (audioID == 169) {
        _audioID = 82;
    }
    else if (audioID == 172) {
        _audioID = 52;
    }
    
    return _audioID
}

func secondLetter(audioID: Int) -> Int {
    
    var _audioID = audioID;
    if (audioID == 5) {
        _audioID = 80; }
    else if (audioID == 8) {
        _audioID = 53; }
    else if (audioID == 11) {
        _audioID = 71; }
    else if (audioID == 14) {
        _audioID = 26; }
    else if (audioID == 17) {
        _audioID = 11; }
    else if (audioID == 20) {
        _audioID = 17; }
    else if (audioID == 23) {
        _audioID = 50; }
    else if (audioID == 26) {
        _audioID = 68; }
    else if (audioID == 29) {
        _audioID = 44; }
    else if (audioID == 32) {
        _audioID = 62; }
    else if (audioID == 35) {
        _audioID = 59; }
    else if (audioID == 38) {
        _audioID = 29; }
    else if (audioID == 41) {
        _audioID = 56; }
    else if (audioID == 44) {
        _audioID = 35; }
    else if (audioID == 47) {
        _audioID = 47; }
    else if (audioID == 50) {
        _audioID = 65; }
    else if (audioID == 53) {
        _audioID = 8; }
    else if (audioID == 56) {
        _audioID = 14; }
    else if (audioID == 59) {
        _audioID = 74; }
    else if (audioID == 62) {
        _audioID = 20; }
    else if (audioID == 65) {
        _audioID = 23; }
    else if (audioID == 68) {
        _audioID = 38; }
    else if (audioID == 71) {
        _audioID = 83; }
    else if (audioID == 74) {
        _audioID = 41; }
    else if (audioID == 77) {
        _audioID = 77; }
    else if (audioID == 80) {
        _audioID = 5; }
    else if (audioID == 83) {
        _audioID = 2; }
    else if (audioID == 86) {
        _audioID = 32; }
    else if (audioID == 89) {
        _audioID = 83; }
    else if (audioID == 92) {
        _audioID = 5; }
    else if (audioID == 95) {
        _audioID = 32; }
    else if (audioID == 98) {
        _audioID = 14; }
    else if (audioID == 101) {
        _audioID = 59; }
    else if (audioID == 104) {
        _audioID = 74; }
    else if (audioID == 107) {
        _audioID = 68; }
    else if (audioID == 110) {
        _audioID = 35; }
    else if (audioID == 113) {
        _audioID = 17; }
    else if (audioID == 116) {
        _audioID = 41; }
    else if (audioID == 119) {
        _audioID = 23; }
    else if (audioID == 122) {
        _audioID = 26; }
    else if (audioID == 125) {
        _audioID = 56; }
    else if (audioID == 128) {
        _audioID = 29; }
    else if (audioID == 131) {
        _audioID = 50; }
    else if (audioID == 134) {
        _audioID = 38; }
    else if (audioID == 137) {
        _audioID = 20; }
    else if (audioID == 140) {
        _audioID = 77; }
    else if (audioID == 143) {
        _audioID = 71; }
    else if (audioID == 146) {
        _audioID = 11; }
    else if (audioID == 149) {
        _audioID = 65; }
    else if (audioID == 152) {
        _audioID = 62; }
    else if (audioID == 155) {
        _audioID = 47; }
    else if (audioID == 158) {
        _audioID = 2; }
    else if (audioID == 161) {
        _audioID = 44; }
    else if (audioID == 164) {
        _audioID = 8; }
    else if (audioID == 167) {
        _audioID = 80; }
    else if (audioID == 170) {
        _audioID = 83; }
    else if (audioID == 173) {
        _audioID = 53; }
    
    return _audioID
}

func thirdLetter(audioID: Int) -> Int {
    
    var _audioID = audioID;
    if (audioID == 5) {
        _audioID = 80; }
    else if (audioID == 9) {
        _audioID = 54; }
    else if (audioID == 12) {
        _audioID = 72; }
    else if (audioID == 15) {
        _audioID = 27; }
    else if (audioID == 18) {
        _audioID = 12; }
    else if (audioID == 21) {
        _audioID = 18; }
    else if (audioID == 24) {
        _audioID = 51; }
    else if (audioID == 27) {
        _audioID = 69; }
    else if (audioID == 30) {
        _audioID = 45; }
    else if (audioID == 33) {
        _audioID = 63; }
    else if (audioID == 36) {
        _audioID = 60; }
    else if (audioID == 39) {
        _audioID = 30; }
    else if (audioID == 42) {
        _audioID = 57; }
    else if (audioID == 45) {
        _audioID = 36; }
    else if (audioID == 48) {
        _audioID = 48; }
    else if (audioID == 51) {
        _audioID = 66; }
    else if (audioID == 54) {
        _audioID = 9; }
    else if (audioID == 57) {
        _audioID = 15; }
    else if (audioID == 60) {
        _audioID = 75; }
    else if (audioID == 63) {
        _audioID = 21; }
    else if (audioID == 66) {
        _audioID = 24; }
    else if (audioID == 69) {
        _audioID = 39; }
    else if (audioID == 72) {
        _audioID = 84; }
    else if (audioID == 75) {
        _audioID = 42; }
    else if (audioID == 78) {
        _audioID = 78; }
    else if (audioID == 81) {
        _audioID = 6; }
    else if (audioID == 84) {
        _audioID = 3; }
    else if (audioID == 87) {
        _audioID = 33; }
    else if (audioID == 90) {
        _audioID = 84; }
    else if (audioID == 93) {
        _audioID = 6; }
    else if (audioID == 96) {
        _audioID = 33; }
    else if (audioID == 99) {
        _audioID = 15; }
    else if (audioID == 102) {
        _audioID = 60; }
    else if (audioID == 105) {
        _audioID = 75; }
    else if (audioID == 108) {
        _audioID = 69; }
    else if (audioID == 111) {
        _audioID = 36; }
    else if (audioID == 114) {
        _audioID = 18; }
    else if (audioID == 117) {
        _audioID = 42; }
    else if (audioID == 120) {
        _audioID = 24; }
    else if (audioID == 123) {
        _audioID = 27; }
    else if (audioID == 126) {
        _audioID = 57; }
    else if (audioID == 129) {
        _audioID = 30; }
    else if (audioID == 132) {
        _audioID = 51; }
    else if (audioID == 135) {
        _audioID = 39; }
    else if (audioID == 138) {
        _audioID = 21; }
    else if (audioID == 141) {
        _audioID = 78; }
    else if (audioID == 144) {
        _audioID = 72; }
    else if (audioID == 147) {
        _audioID = 12; }
    else if (audioID == 150) {
        _audioID = 66; }
    else if (audioID == 153) {
        _audioID = 63; }
    else if (audioID == 156) {
        _audioID = 48; }
    else if (audioID == 159) {
        _audioID = 3; }
    else if (audioID == 162) {
        _audioID = 45; }
    else if (audioID == 165) {
        _audioID = 9; }
    else if (audioID == 168) {
        _audioID = 81; }
    else if (audioID == 171) {
        _audioID = 84; }
    else if (audioID == 174) {
        _audioID = 54; }
    
    return _audioID
}

struct AudioHelper {
    
    @Binding var player: Player        
    
    func audioName(name: String) -> String {
        
        return switch name.count {
        case 1: "00\(name)"
        case 2: "0\(name)"
        default: name
        }
    }
    
    func filePath(name: String) -> URL {
        
        return FileManager.default.urls(for: .documentDirectory, in: .userDomainMask)[0].appendingPathComponent(name)
    }
    
    func fileExist(name: String) -> Bool {
        return FileManager.default.fileExists(atPath: filePath(name: name).relativePath)
    }
    
    func createDir(name: String) {
        
        try! FileManager.default.createDirectory(at: filePath(name: name), withIntermediateDirectories: true)
    }
    
    func prepareRecitationDir() {
        
        if (!fileExist(name: "recitation")) {
            createDir(name: "recitation")
        }
        
        for i in (1...11) {
            
            if (!fileExist(name: "recitation/\(i)")) {
                createDir(name: "recitation/\(i)")
            }
        }
        
        if (!fileExist(name: "recitation/w")) {
            createDir(name: "recitation/w")
        }
        
        if (!fileExist(name: "translation")) {
            createDir(name: "translation")
        }
        
        if (!fileExist(name: "translation/English")) {
            createDir(name: "translation/English")
        }
        
        if (!fileExist(name: "translation/French")) {
            createDir(name: "translation/French")
        }
        
        if (!fileExist(name: "translation/Portuguese")) {
            createDir(name: "translation/Portuguese")
        }
        
        if (!fileExist(name: "translation/Spanish")) {
            createDir(name: "translation/Spanish")
        }
        
        if (!fileExist(name: "translation/Swahili")) {
            createDir(name: "translation/Swahili")
        }
    }
    
    func checkVerse(fileName: String) -> Bool {

        if (fileExist(name: fileName)) {
            return true
        }
        else {
            return false
        }
    }
    
    func downloadVerse(fileName: String, url: URL, callback: (() -> ())?) {
        
        if (!fileExist(name: fileName)) {
            
            Task.detached {
                
                let downloadTask = URLSession.shared.downloadTask(with: url) {
                    urlOrNil, responseOrNil, errorOrNil in
                    // check for and handle errors:
                    // * errorOrNil should be nil
                    // * responseOrNil should be an HTTPURLResponse with statusCode in 200..<299
                    
                    guard let fileURL = urlOrNil else { return }
                    do {
                        let documentsURL = try
                        FileManager.default.url(for: .documentDirectory,
                                                in: .userDomainMask,
                                                appropriateFor: nil,
                                                create: false)
                        let savedURL = documentsURL.appendingPathComponent(fileName)
                        try FileManager.default.moveItem(at: fileURL, to: savedURL)
                        
                        callback?()
                        
                    } catch {
                        print ("file error: \(error)")
                    }
                }
                downloadTask.resume()
            }
        }
        else {
            
            callback?()
        }
    }
    
    func playVerse(audioFileName: String, callback: (() -> ())? = nil) {

        //let url = Bundle.main.(forResource: audioFileName.replacingOccurrences(of: ".mp3", with: ""), ofType: "mp3")
        let url = filePath(name: audioFileName)
        
        if (try! url.checkResourceIsReachable()) {
            
            player.play(url: url)
        }
    }
    
    func pauseVerse() {

        player.pause()
    }

    func startVerse() {

        player.play()
    }
}
